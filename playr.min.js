/**
 * Playr
 *
 * @author Julien 'delphiki' Villetorte <gdelphiki@gmail.com>
 * http://twitter.com/delphiki
 * http://www.delphiki.com/html5/playr
 */
function Playr(k,n){this.config={fontSize:"12pt",customFontSize:"12pt",defaultVolume:0.75,skipStep:5,volumeStep:0.1,subsDelayStep:0.5};this.base64images={fullscreen_control:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAABGdBTUEAALGPC/xhBQAAAwBQTFRFAAAA////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAZ3bsYwAAAQB0Uk5T////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AFP3ByUAAAAZdEVYdFNvZnR3YXJlAFBhaW50Lk5FVCB2My41Ljg3O4BdAAAAPklEQVQoU7VPSQoAQAiy/z+6UhJmu46X1IIUQaQgCit7iJy9brIvOAbkNOyIwlvPP8b19hHsjL5oFu62e/0CFqTLaX136gAAAAAASUVORK5CYII=",
pause_control:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAABGdBTUEAALGeYUxB9wAAACBjSFJNAAB6JQAAgIMAAPn/AACA6AAAUggAARVYAAA6lwAAF2/XWh+QAAACgklEQVR42lyR22pbRxSGv5nZZ21H2kqxIrdur+JQ0ppepPEjhIS0F3Gfpn2Y4pbSF+gDlARKIL02hIJTCsanOKmsw97aM7OmF5LlqAsGBr41//rXPyqEwOMnTz978PWDfRExCsVoNGoODn78dTIev7390SZ7e3t3H+49/LZpGq21Vm8vLiY//3Twy3Q6HUUAu7tfPvpuf/+HWV0rEUEk2Jcv/3jz56tXv03GV9y7t/PN/rNn34+urlQIgdba5sWL54fA7xrg7s7Obrfb65dlWRVFp9ocDDY//mR7F6BpagaDwVfdXtXf2Nioik6nunNnOBwOtz4HiBZNTTurZ9R1g/celMLa1rKsZj5v6w+4SMA661YC3nusdVjn8N4TOUeQcP0eEaFt7YprYyAs+FJAsNZinUWWdwk3At57rLM4Z/FeMMYgywEawIvHOodbHvlg+rWDBfNLLiumryc45/DOE4A4jtBK3TgQobUW5xxKKZIkQWu1voKXhbUoMvy/JpMpR3//Q9s0pGmK0nrFIgAFJHGMbVsu370nzeq1DMQL3jkkLPKZzWarNSMAbTTT6ZTziwuMiej3CyJz40QbTZalRMaQJDFlWWKWPAJoW8vVeEye52RpxkZZYsyNTRNp8izHx44sTdd4BGCMpuyUaA1ZltO9dWsti9jEdDoF4j15vuBrDsqyjHu9LlorOkXB7aoiidPoWqDI87jqdhEROkVBv+oRx7FZfeNfr18fpUni8jSVyBh5P/rXHh8fHwNorTk/PztKksRlWSJRZOTy8t389OT0FECFEFBKxdvbn36htYoXmbT25OTkEJgrpTDGpMOtrftaKQNKNU09Pzs7Owwh2P8GAAruVo9cZ9KlAAAAAElFTkSuQmCC",
play_control:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACUklEQVR42mNkAAIOTk4mTU0tdXsHB5sF8+ct//D+/RcGIgEjiFBT1xDz8vJOjImNqezu6qpctXLFjP9AQLQBAUHBup6enmUe7h4x33/8YNixY/v27q7OnKdPntwjygBvX18tV1e3Umdnl4RPnz4BvcTB8Orlq/fTpk2p2Lxx4yyCBnj5+Gk5OTuVOjg4Jnz+/Inh9+8/QBlGBjZWVoajR45snzZlcs7Tp9hdAzbAw9tHy9HRsdTWxi7h0+fPDH/+/mH4/+8fAyMTEwM/Pz/Dl8+f38+YPrVi4/r1s7Ab4OWjZWdnV2ppbZ3w5QskAliYmRlYWFjAmJubm4GPl5dh794929paWkCuuY9igLuHl5aNrW2phZVVwq+fPxlYgU6HY6ABbOxsDBzs7AxioqIMHz58+BQcHOR/4fz5A3AD3KAG2DvYJ/z+BfQ/w3+4F9jYWBm4ODnBrhAVEWEAWRAQ4B9x6tSpDUCFPyEu8PTWsre3L7WysUn48P4DSDvYRm4uLgYeoEYBAX4GPj4+hj179lytqqosuHf37h6MQLS0tCo1MjZJ+P//HwMPUCPIRh4ebgYRYWGGjx8//u7o6JgKTKVN//79e48RiJ7evlrWNjaltra2CUxMjGBb+YE2gmIAZGt1VWXhnTt3duNPB05OpW5ubgnMQH+LiAgzfPr48U87xNZGdFuxJOUQHU9Pj/KAgIAYUPQBo+tqVSVuWzEMUFJWlgoODslKT0+v7uzsmDx37tz6f3//viekGW4ACLCzs3Pz8vLKvHnz5jaQ+48YzSAAAGPF5xGsLhIBAAAAAElFTkSuQmCC",
sound_control:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAH0SURBVDjLxdPPS9tgGAfwgH/ATmPD0w5jMFa3IXOMFImsOKnbmCUTacW1WZM2Mf1ho6OBrohkIdJfWm9aLKhM6GF4Lz3No/+AMC/PYQXBXL1+95oxh1jGhsgOX/LywvN5n/fN+3IAuKuEuzagVFoO27b1/Z+BcrnUx4otx7FPLWsJvYpIM2SS9H4PqNWqfK1W8VKplHlW/G1zs4G9vS9YXPx4CaDkXOFES4Om4gceUK2WsbZWR72+gtXVFezsbKHVamF7ewtm/sMFgBJZhd6pvm4kDndaAo2KOmt5Gfv7X9HpdNBut9FsNmFZFgPrMHKZc4DkjHyi6KC3MZNehTOuGAH5Xx5ybK/Y3f0Mx3Fg2zaKxSIMw2DjT0inNQ84nogcUUQJHIfZquNT3hzx46DBALizg2o01qEoCqLRKERRRDAYhKYlWRK/AJdCMwH2BY28+Qk8fg667wdXKJjY2FiHaeaRzWYQCk1AEASGzSCZjP/ewtik5r6eBD0dM+nRSMb1j4LuPDnkFhZymJ/PsmLdazmV0jxEkqKsK+niIQ69mKUBwdd9OAx3SADdHtC53FyK12dVXlVlPpF4zytK7OgMyucNyHLs8m+8+2zJHRwG3fId9LxIbNU+OR6zWU57AR5y84FKN+71//EqM2iapfv/HtPf5gcdtKR8VW88PgAAAABJRU5ErkJggg==",
mute_control:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAFsSURBVDjLxZO/SwJhHMYF16b+gP6GZiehwcm7hBORKLXzPT1SIhMUHCKO48TT88emhwchHTiEERQhTrlE1FIhQS1BGRTU5vr0ntgS6BFBDR94eeH5fPk+L68DgOM3OP5MUCjkg7IsPf9YoKoFJw1LiiKPJGkX7wyToCxMFWhayaVpxTHFouqi4ftmU0enc4CTGLEE15T5qYJSSUWtVkW1WkalUkartYd2u43zbBZPPp8lMGeuoKp59Ptn6PV66Ha7MAwDp6KIIcfh1u+3BHMzBXRXmOY+FEWBLMs4FoTx5LtgENuJOGxLtIrS9ToIITADATwyDC69XmzGBYiiYC/I5bJoNOo44vnx5CuWgcftRii0iliMtxek01s4jIRoeBk3dO/URhw+eo7QO0Ii9oIBx+lvLPvxwrKDnfW1JULCD8mkiEwmhWg0PFtAG16kvFIuvtqmU51RPixTRraCicTz/akmohXK8P8+0zQ+AXBHwZp9sfnqAAAAAElFTkSuQmCC"};
this.nativeTrackSupport="track"in document.createElement("track");this.ready=this.setupStarted=!1;this.video_id=k;this.video=n;this.isHoldingVolume=this.isHoldingTime=this.isTrueFullscreen=this.isFullscreen=this.captions_refresh=this.timecode_refresh=!1;this.fsVideoStyle=this.fsStyle=this.focusedElem=null;this.track_tags=[];this.current_track=-1;this.subs=[];this.chapters=[];this.subtitlesDelay=0;"undefined"==typeof Playr.initialized&&(Playr.prototype.init=function(){if(!this.ready&&!this.setupStarted){this.setupStarted=
!0;var b=this.video.offsetWidth,a=this.video.offsetHeight,c=document.createElement("div"),d=document.createAttribute("class");d.nodeValue="playr_wrapper";c.setAttributeNode(d);d=document.createAttribute("id");d.nodeValue="playr_wrapper_"+this.video_id;c.setAttributeNode(d);d=document.createAttribute("tabindex");d.nodeValue="0";c.setAttributeNode(d);d=document.createAttribute("id");d.nodeValue="playr_video_"+this.video_id;this.video.setAttributeNode(d);this.video.removeAttribute("controls");c.innerHTML=
'<div class="playr_captions_wrapper" id="playr_captions_wrapper_'+this.video_id+'"><div class="playr_top_overlay" id="playr_top_overlay_'+this.video_id+'"><a href="http://www.delphiki.com/html5/playr/">Playr</a></div><div class="playr_video_container" id="playr_video_container_'+this.video_id+'"></div><div class="playr_captions" id="playr_captions_'+this.video_id+'"></div></div><ul class="playr_controls" id="playr_controls_'+this.video_id+'" role="menubar"><li><button class="playr_play_btn" id="playr_play_btn_'+
this.video_id+'" tabindex="0"><img src="'+this.base64images.play_control+'" id="playr_play_img_'+this.video_id+'" alt="play" /></button></li><li><div class="playr_timebar" id="playr_timebar_'+this.video_id+'" tabindex="0" role="slider" aria-valuemin="0" aria-valuemax="0" aria-valuenow="0"><div class="playr_timebar_buffer" id="playr_timebar_buffer_'+this.video_id+'"></div><div class="playr_timebar_inner" id="playr_timebar_inner_'+this.video_id+'"><div class="playr_timebar_pos"></div></div></div><span class="playr_timebar_notice" id="playr_timebar_notice_'+
this.video_id+'">00:00</span></li><li><span id="playr_video_curpos_'+this.video_id+'" role="timer">00:00</span> / <span id="playr_video_duration_'+this.video_id+'">00:00</span></li><li><button class="playr_mute_btn" id="playr_mute_btn_'+this.video_id+'" tabindex="0"><img src="'+this.base64images.sound_control+'" class="playr_mute_icon" id="playr_mute_icon_'+this.video_id+'" alt="mute" /></button><div class="playr_volume_ctrl" id="playr_volume_ctrl_'+this.video_id+'" tabindex="0" role="slider" aria-valuemin="0" aria-valuemax="1" aria-valuenow="'+
this.config.defaultVolume+'" tabindex="0"><div class="playr_volumebar" id="playr_volumebar_'+this.video_id+'"><div class="playr_volumebar_inner" id="playr_volumebar_inner_'+this.video_id+'"><div class="playr_volumebar_pos"></div></div></div></div></li><li><button class="playr_captions_btn" id="playr_captions_btn_'+this.video_id+'" tabindex="0">Menu</button><ul class="playr_cc_tracks" id="playr_cc_tracks_'+this.video_id+'"><li class="playr_menu_title">Subtitles &amp; Captions</li><li class="playr_subtitles_item" id="playr_cc_track_'+
this.video_id+'_none"><label for="playr_current_cc_'+this.video_id+'_none"><input type="radio" name="playr_current_cc_'+this.video_id+'" id="playr_current_cc_'+this.video_id+'_none" value="-1" /> None</label></li></ul></li><li><button class="playr_fullscreen_btn" id="playr_fullscreen_btn_'+this.video_id+'" tabindex="0"><img src="'+this.base64images.fullscreen_control+'" alt="fullscreen" /></button></li></ul>';this.video.parentNode.insertBefore(c,this.video);document.getElementById("playr_video_container_"+
this.video_id).appendChild(this.video);document.getElementById("playr_video_container_"+this.video_id).style.height=a+"px";document.getElementById("playr_wrapper_"+this.video_id).style.width=b+"px";this.video.volume=this.config.defaultVolume;this.initEventListeners();this.loadTrackTags();this.ready=!0}},Playr.prototype.setNativeTrackSupport=function(b){this.nativeTrackSupport=b},Playr.prototype.initEventListeners=function(){var b=this;this.video.addEventListener("click",function(){b.play();return!1},
!1);this.video.addEventListener("timeupdate",function(){b.timeCode();b.displayCaptions()},!1);this.video.addEventListener("ended",function(){b.eventEnded()},!1);this.video.addEventListener("play",function(){b.playEvent()},!1);this.video.addEventListener("pause",function(){b.playEvent()},!1);this.video.addEventListener("volumechange",function(){b.volumeChangedEvent()},!1);this.video.addEventListener("progress",function(){b.progressEvent()},!1);document.addEventListener("mozfullscreenchange",function(){!document.mozFullScreen&&
b.isTrueFullscreen&&b.fullscreen()},!1);document.addEventListener("webkitfullscreenchange",function(){!document.webkitIsFullScreen&&b.isTrueFullscreen&&b.fullscreen()},!1);document.getElementById("playr_play_btn_"+this.video_id).addEventListener("click",function(){b.play()},!1);document.getElementById("playr_timebar_"+this.video_id).addEventListener("mousedown",function(){b.isHoldingTime=!0},!1);document.getElementById("playr_timebar_"+this.video_id).addEventListener("mouseup",function(a){b.isHoldingTime=
!1;b.setPosition(a,!0)},!1);document.getElementById("playr_timebar_"+this.video_id).parentNode.addEventListener("mousemove",function(a){b.noticeTimecode(a);b.isHoldingTime&&b.setPosition(a,!1)},!1);document.getElementById("playr_volumebar_"+this.video_id).addEventListener("mousedown",function(){b.isHoldingVolume=!0},!1);document.getElementById("playr_volumebar_"+this.video_id).addEventListener("mouseup",function(a){b.isHoldingVolume=!1;b.setVolume(a)},!1);document.getElementById("playr_volumebar_"+
this.video_id).addEventListener("mousemove",function(a){b.isHoldingVolume&&b.setVolume(a)},!1);document.getElementById("playr_mute_btn_"+this.video_id).addEventListener("click",function(){b.toggleMute()},!1);document.getElementById("playr_fullscreen_btn_"+this.video_id).addEventListener("click",function(){b.fullscreen()},!1);document.getElementById("playr_wrapper_"+this.video_id).addEventListener("focus",function(){b.focusedElem="playr"},!1);document.getElementById("playr_play_btn_"+this.video_id).addEventListener("focus",
function(){b.focusedElem="play_btn"},!1);document.getElementById("playr_timebar_"+this.video_id).addEventListener("focus",function(){b.focusedElem="timebar"},!1);document.addEventListener("keydown",function(a){b.keyboard(a)},!1);document.addEventListener("mousewheel",function(a){b.scrollHandler(a)},!1);document.addEventListener("DOMMouseScroll",function(a){b.scrollHandler(a)},!1);window.addEventListener("resize",function(){b.isFullscreen&&!b.isTrueFullscreen&&b.updateFullscreen()},!1)},Playr.prototype.play=
function(){this.video.paused?this.video.play():this.video.pause();return!1},Playr.prototype.playEvent=function(){this.video.paused?(document.getElementById("playr_play_img_"+this.video_id).src=this.base64images.play_control,document.getElementById("playr_play_img_"+this.video_id).alt="play"):(document.getElementById("playr_play_img_"+this.video_id).src=this.base64images.pause_control,document.getElementById("playr_play_img_"+this.video_id).alt="pause")},Playr.prototype.toggleMute=function(){this.video.muted=
this.video.muted?!1:!0;return!1},Playr.prototype.setVolume=function(b){var a=document.getElementById("playr_volumebar_"+this.video_id),c=this.findPos(a);b=100-Math.round(100*(b.pageY-c.y)/a.offsetHeight);100>=b&&(document.getElementById("playr_volumebar_inner_"+this.video_id).style.height=b.toString()+"%",this.video.volume=b/100,document.getElementById("playr_volume_ctrl_"+this.video_id).setAttribute("aria-valuenow",b/100))},Playr.prototype.volumeChangedEvent=function(){1>=this.video.volume&&(document.getElementById("playr_volumebar_inner_"+
this.video_id).style.height=(100*this.video.volume).toString()+"%");this.video.muted?(document.getElementById("playr_mute_icon_"+this.video_id).src=this.base64images.mute_control,document.getElementById("playr_mute_icon_"+this.video_id).alt="unmute"):(document.getElementById("playr_mute_icon_"+this.video_id).src=this.base64images.sound_control,document.getElementById("playr_mute_icon_"+this.video_id).alt="mute")},Playr.prototype.timeCode=function(){document.getElementById("playr_timebar_"+this.video_id).setAttribute("aria-valuemax",
Math.round(100*this.video.duration)/100);document.getElementById("playr_timebar_"+this.video_id).setAttribute("aria-valuenow",this.video.currentTime);document.getElementById("playr_video_curpos_"+this.video_id).innerHTML=this.parseTimeCode(this.video.currentTime);!isNaN(this.video.duration)&&"00:00"==document.getElementById("playr_video_duration_"+this.video_id).innerHTML&&(document.getElementById("playr_video_duration_"+this.video_id).innerHTML=this.parseTimeCode(this.video.duration));this.isHoldingTime||
(document.getElementById("playr_timebar_inner_"+this.video_id).style.width=100*this.video.currentTime/this.video.duration+"%")},Playr.prototype.parseTimeCode=function(b){b=Math.floor(b);for(var a=0;0<b-60;)b-=60,a++;b=b.toString();1==b.length&&(b="0"+b);a=a.toString();1==a.length&&(a="0"+a);return a+":"+b},Playr.prototype.findPos=function(b){var a=y=0;if(b.offsetParent){do a+=b.offsetLeft,y+=b.offsetTop;while(b=b.offsetParent)}return{x:a,y:y}},Playr.prototype.setPosition=function(b,a){var c=document.getElementById("playr_timebar_"+
this.video_id),d=this.findPos(c),c=Math.round(100*(b.pageX-d.x)/c.offsetWidth);document.getElementById("playr_timebar_inner_"+this.video_id).style.width=c.toString()+"%";a&&(this.video.currentTime=Math.round(c*this.video.duration/100))},Playr.prototype.progressEvent=function(){if(0!=this.video.buffered.length){this.video.buffered.start(0);var b=this.video.buffered.end(0);if(b==this.video.duration)document.getElementById("playr_timebar_buffer_"+this.video_id).style.width=document.getElementById("playr_timebar_"+
this.video_id).offsetWidth-2+"px";else{var a=document.getElementById("playr_timebar_"+this.video_id).offsetWidth,b=Math.round(b*a/this.video.duration);document.getElementById("playr_timebar_buffer_"+this.video_id).style.width=b+"px"}}},Playr.prototype.fullscreen=function(){var b=document.querySelectorAll(".playr_wrapper"),a=document.getElementById("playr_wrapper_"+this.video_id);document.getElementById("playr_captions_"+this.video_id);if(this.isFullscreen){document.cancelFullscreen?document.cancelFullscreen():
document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen();for(i=0;i<b.length;i++)b[i].style.visibility="visible";a.style.backgroundColor="transparent";a.style.position="inherit";a.style.height=this.fsStyle.height;a.style.width=this.fsStyle.width;a.style.left=0;a.style.marginLeft=0;this.video.style.height=this.fsVideoStyle.height+"px";this.video.style.width=this.fsVideoStyle.width+
"px";document.body.style.overflow="auto";this.isFullscreen=this.isTrueFullscreen=!1;a.className=a.className.replace(/(\s|^)playr_is_fullscreen(\s|$)/," ").replace(/^\s+|\s+$/g,"")}else{for(i=0;i<b.length;i++)b[i].style.visibility="hidden";a.style.visibility="visible";this.fsStyle={height:a.style.height,width:a.style.width};this.fsVideoStyle={height:this.video.offsetHeight,width:this.video.offsetWidth};a.requestFullscreen?(this.isTrueFullscreen=!0,a.requestFullscreen()):a.mozRequestFullScreen?(this.isTrueFullscreen=
!0,a.mozRequestFullScreen()):a.webkitRequestFullScreen&&(this.isTrueFullscreen=!0,a.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT));this.isTrueFullscreen?(console.log("True fullscreen"),a.style.position="fixed",a.style.top=0,a.style.left=0,a.style.height="100%",a.style.width="100%",a.style.backgroundColor="#000000",this.video.style.width="100%",this.video.style.height=screen.height-30+"px"):(console.log("Fake fullscreen"),a.style.backgroundColor="#000000",a.style.position="fixed",a.style.top=
0,a.style.left="50%",a.style.height=window.innerHeight+"px",a.style.width=window.innerWidth+"px",a.style.marginLeft="-"+Math.round(a.offsetWidth/2)+"px",this.video.style.width=window.innerWidth+"px",this.video.style.height=window.innerHeight-30+"px");document.body.style.overflow="hidden";this.isFullscreen=!0;a.className+=(a.className?" ":"")+"playr_is_fullscreen"}document.getElementById("playr_video_container_"+this.video_id).style.height=this.video.offsetHeight+"px";return!1},Playr.prototype.updateFullscreen=
function(){var b=document.getElementById("playr_wrapper_"+this.video_id);b.style.height=window.innerHeight+"px";b.style.width=window.innerWidth+"px";this.video.style.width=window.innerWidth+"px";this.video.style.height=window.innerHeight-30+"px";b.style.marginLeft="-"+Math.round(b.offsetWidth/2)+"px";b=Math.round(100*((window.innerHeight-30)/this.fsVideoStyle.height))/100;document.getElementById("playr_captions_"+this.video_id).style.fontSize=b+"em"},Playr.prototype.loadTrackTags=function(){this.track_tags=
this.video.getElementsByTagName("track");for(i=0;i<this.track_tags.length;i++){var b=document.createAttribute("id");b.nodeValue="playr_track_"+this.video_id+"_"+i;this.track_tags[i].setAttributeNode(b)}0<this.track_tags.length&&this.loadTrackContent(0)},Playr.prototype.loadTrackContent=function(b){var a=this,c=a.track_tags[b],d=new XMLHttpRequest;d.open("GET",c.getAttribute("src"));d.onreadystatechange=function(){if(4==d.readyState&&(200==d.status||0==d.status)){if(""!=d.responseText){var e=c.getAttribute("kind");
if(null==e||""==e)e="subtitles";a.parseTrack(d.responseText,e);if("subtitles"==e||"captions"==e||"descriptions"==e){var e=c.getAttribute("label"),f=c.getAttribute("srclang");track_label=null!=e?e:null!=f?f:"Track "+(b+1);e='<li class="playr_subtitles_item"><label for="playr_current_cc_'+a.video_id+"_"+b+'"><input type="radio" name="playr_current_cc_'+a.video_id+'" id="playr_current_cc_'+a.video_id+"_"+b+'" value="'+b+'" /> '+track_label+"</label></li>";document.getElementById("playr_cc_tracks_"+a.video_id).innerHTML+=
e}}b++;b<a.track_tags.length?a.loadTrackContent(b):(a.buildChaptersMenu(),a.setDefaultTrack())}};d.send(null)},Playr.prototype.setDefaultTrack=function(){var b=document.getElementsByTagName("html")[0].getAttribute("lang"),a=document.querySelectorAll('input[name="playr_current_cc_'+this.video_id+'"]'),c=0,d=this;a[0].addEventListener("change",function(){d.setActiveTrack()},!1);for(i=0;i<this.track_tags.length;i++)"subtitles"==this.track_tags[i].getAttribute("kind")&&(this.track_tags[i].getAttribute("srclang")==
b&&0==c&&(c=i+1),this.track_tags[i].hasAttribute("default")&&(c=i+1),a[i+1].addEventListener("change",function(){d.setActiveTrack()},!1));a[c]?a[c].checked=!0:a[0].checked=!0;this.setActiveTrack()},Playr.prototype.setActiveTrack=function(){var b=document.querySelectorAll("#playr_cc_tracks_"+this.video_id+" li.playr_subtitles_item"),a=document.querySelectorAll('input[name="playr_current_cc_'+this.video_id+'"]');for(i=0;i<a.length;i++)b[i].className=a[i].checked?"playr_subtitles_item active_track":
"playr_subtitles_item"},Playr.prototype.tc2sec=function(b){b=b.split(":");return 3600*b[0]+60*b[1]+parseFloat(b[2].replace(",","."))},Playr.prototype.parseTrack=function(b,a){if("subtitles"==a||"captions"==a||"descriptions"==a)var c=/^([0-9]+)$/;else"chapters"==a&&(c=/^chapter-([0-9])+$/);var d=/^([0-9]{2}:[0-9]{2}:[0-9]{2}[,.]{1}[0-9]{3}) --\> ([0-9]{2}:[0-9]{2}:[0-9]{2}[,.]{1}[0-9]{3})(.*)$/,e=b.split(/\r?\n/),f=[];for(i=0;i<e.length;i++)if(identifier=c.exec(e[i])){i++;var g=d.exec(e[i]);if(g&&
i<e.length){i++;var h=e[i];for(i++;""!=e[i]&&i<e.length;)h=h+"\n"+e[i],i++;f.push({identifier:identifier[0],start:this.tc2sec(g[1]),stop:this.tc2sec(g[2]),start_tc:g[1],stop_tc:g[2],text:h,settings:g[3]})}}switch(a){case "chapters":this.chapters.push(f);break;default:this.subs.push(f)}},Playr.prototype.buildChaptersMenu=function(){var b=this,a=document.getElementById("playr_cc_tracks_"+this.video_id);if(0<this.chapters.length){var c='<li class="playr_chapters_menu_title" id="playr_chapters_menu_title_'+
this.video_id+'">Chapters <span style="float:right;">&gt;</span><ul class="playr_chapters_menu">';for(i=0;i<this.chapters[0].length;i++)c+='<li><a href="#'+this.chapters[0][i].start_tc+'" class="playr_chapter_'+this.video_id+'" id="playr_chapter_'+this.video_id+"_"+i+'">'+this.chapters[0][i].text+"</a> ("+this.chapters[0][i].start_tc.split(".")[0]+")</li>";a.innerHTML=c+"</ul></li>"+a.innerHTML}a=document.querySelectorAll(".playr_chapter_"+this.video_id);for(i=0;i<a.length;i++)a[i].addEventListener("click",
function(){b.goToChapter(this);return!1},!1)},Playr.prototype.goToChapter=function(b){b=b.getAttribute("href").split("#")[1];this.video.currentTime=this.tc2sec(b);return!1},Playr.prototype.displayCaptions=function(){if(!this.nativeTrackSupport){for(var b=document.getElementById("playr_captions_"+this.video_id),a=document.querySelectorAll('input[name="playr_current_cc_'+this.video_id+'"]'),c=0;c<a.length;c++)a[c].checked&&(this.current_track=a[c].value);if(0<=this.current_track)for(c=0;c<this.subs[this.current_track].length;c++)if(this.video.currentTime+
this.subtitlesDelay>=this.subs[this.current_track][c].start&&this.video.currentTime+this.subtitlesDelay<=this.subs[this.current_track][c].stop){for(var a=this.subs[this.current_track][c].text,d=document.getElementById("playr_captions_wrapper_"+this.video_id),e=["text-align:center"],f=[],g=[],h=[],j=/<v ([^>]+)>/i;test_vd=j.exec(a);)a=a.replace(test_vd[0],'<span class="'+test_vd[1].replace(" ","_")+'">');for(j=/<c\.([a-z0-9-_.]+)>/i;test_classes=j.exec(a);)var m=test_classes[1].replace("."," "),a=
a.replace(test_classes[0],'<span class="'+m+'">');a=a.replace(/(<\/v>|<\/c>)/ig,"</span>");j=/<([0-9]{2}:[0-9]{2}:[0-9]{2}[,.]{1}[0-9]{3})>/;for(m=!1;test_timestamps=j.exec(a);)a=this.tc2sec(test_timestamps[1])<this.video.currentTime?a.replace(test_timestamps[0],'</span><span class="playr_cue_past">'):a.replace(test_timestamps[0],'</span><span class="playr_cue_future">'),m=!0;m&&(a='<span class="playr_cue_past">'+a);if(""!=this.subs[this.current_track][c].settings){var j=/(A|align):(start|middle|end)/i.exec(this.subs[this.current_track][c].settings),
m=/(S|size):([0-9]{0,3})%/i.exec(this.subs[this.current_track][c].settings),l=/(T|position):([0-9]{0,3})%/i.exec(this.subs[this.current_track][c].settings),k=/(D|vertical):(vertical-lr|vertical|lr|rl)/i.exec(this.subs[this.current_track][c].settings),c=/(L|line):(-?[0-9]{0,3})(%?)/i.exec(this.subs[this.current_track][c].settings);j&&("start"==j[2]?f.push("text-align:left"):"middle"==j[2]?f.push("text-align:center"):"end"==j[2]&&f.push("text-align:right"));l&&0<=l[2]&&50>l[2]?(e.push("text-align:left"),
f.push("margin-left:"+l[1]+"%")):l&&(50<l[2]&&100>=l[2])&&(e.push("text-align:right"),f.push("margin-right:"+(100-l[2])+"%"));m&&(j=m[2]/100*parseInt(this.config.fontSize),f.push("font-size:"+j+"pt"));k&&(h.push("display:block"),h.push("min-height:5px"),h.push("min-width:1px"),a='<span style="'+h.join(";")+'">'+a.split("").join('</span><span style="'+h.join(";")+'">')+"</span>",a=a.replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1</span><br /><span>$2"),g.push("display:block"),g.push("padding:5px"),g.push("text-align:center"),
"vertical-lr"==k[2]||"lr"==k[2]?(g.push("float:left"),f.push("float:left")):(g.push("float:right"),f.push("float:right")),g.push("background-color:rgba(0,0,0,0.75)"),f.push("background:none"),e.push("top:0"),a=a.replace(/<br \/>/,'</span><span style="'+g.join(";")+'">'),a=a.replace(/<span>(\r\n|\n\r|\r|\n)<\/span>/g,""));c&&(-100<=c[2]&&100>=c[2])&&"%"==c[3]&&(h=0>c[2]?"bottom":"top",c=Math.abs(c[2]),e.push(h+":"+c+"%"))}this.isFullscreen&&(h=Math.round(100*((window.innerHeight-30)/this.fsVideoStyle.height))/
100,f.push("font-size:"+Math.round(parseInt(this.config.fontSize)*h)+"pt"));d.setAttribute("class","playr_captions_wrapper");b.setAttribute("class","playr_captions");b.setAttribute("style",e.join(";"));k||(a=a.replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,'$1</span><br /><span style="'+g.join(";")+'">$2'));b.innerHTML='<p style="'+f.join(";")+'"><span style="'+g.join(";")+'">'+a+"</span></p>";b.style.visibility="visible";break}else b.style.visibility="hidden";else b.style.visibility="hidden"}},Playr.prototype.eventEnded=
function(){this.video.currentTime=0;this.video.pause();document.getElementById("playr_play_img_"+this.video_id).src=this.base64images.play_control;document.getElementById("playr_play_img_"+this.video_id).alt="play"},Playr.prototype.noticeTimecode=function(b){var a=document.getElementById("playr_timebar_"+this.video_id),c=document.getElementById("playr_timebar_notice_"+this.video_id),d=this.findPos(a);b=b.pageX-d.x;a=Math.round(100*b/a.offsetWidth);0>a&&(a=0);c.innerHTML=this.parseTimeCode(Math.round(a*
this.video.duration/100));c.style.marginLeft=b+3-c.offsetWidth/2+"px"},Playr.prototype.playrHasFocus=function(){var b=document.activeElement.getAttribute("id");return RegExp("^playr_.+_"+this.video_id+"$").test(b)},Playr.prototype.keyboard=function(b){if(!this.playrHasFocus())return!0;switch(b.keyCode){case 27:this.isFullscreen&&this.fullscreen();break;case 32:this.play();break;case 37:this.video.currentTime=0>this.video.currentTime-this.config.skipStep?0:this.video.currentTime-this.config.skipStep;
b.preventDefault();break;case 38:this.video.volume=1<this.video.volume+this.config.volumeStep?1:this.video.volume+this.config.volumeStep;this.notification("Volume: "+Math.round(100*this.video.volume)+"%");b.preventDefault();break;case 39:this.video.currentTime=this.video.currentTime+this.config.skipStep>this.video.duration?this.video.duration:this.video.currentTime+this.config.skipStep;b.preventDefault();break;case 40:this.video.volume=0>this.video.volume-this.config.volumeStep?0:this.video.volume-
this.config.volumeStep;this.notification("Volume: "+Math.round(100*this.video.volume)+"%");b.preventDefault();break;case 67:this.subtitlesDelay+=this.config.subsDelayStep;this.notification("Subtitles delay: "+this.subtitlesDelay+" second(s)");break;case 68:this.subtitlesDelay=0;this.notification("Subtitles delay: "+this.subtitlesDelay+" second(s)");break;case 88:this.subtitlesDelay-=this.config.subsDelayStep;this.notification("Subtitles delay: "+this.subtitlesDelay+" second(s)");break;case 70:this.fullscreen()}},
Playr.prototype.scrollHandler=function(b){if(!this.playrHasFocus()||!this.isFullscreen)return!0;rolled="wheelDelta"in b?b.wheelDelta:-b.detail;0>rolled?this.video.volume=0>this.video.volume-this.config.volumeStep?0:this.video.volume-this.config.volumeStep:0<rolled&&(this.video.volume=1<this.video.volume+this.config.volumeStep?1:this.video.volume+this.config.volumeStep);this.notification("Volume: "+Math.round(100*this.video.volume)+"%");return!1},Playr.prototype.notification=function(b,a){a||(a=1E3);
var c=document.getElementById("playr_top_overlay_"+this.video_id);c.innerHTML='<span style="font-size:0.7em;">'+b+"</span>";c.style.opacity=1;setTimeout(function(){c.style.opacity=0},a)},Playr.prototype.setup=function(){var b=this;this.video.addEventListener("loadeddata",function(){b.init()},!1);this.video.addEventListener("canplay",function(){b.init()},!1)},Playr.initialized=!0);this.setup()}
window.addEventListener("DOMContentLoaded",function(){var k=document.querySelectorAll("video.playr_video"),n=[];for(v=0;v<k.length;v++)n.push(new Playr(v,k[v]))},!1);
